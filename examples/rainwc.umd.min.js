var RainWC=(()=>{var M=Object.defineProperty;var et=Object.getOwnPropertyDescriptor;var ot=Object.getOwnPropertyNames;var nt=Object.prototype.hasOwnProperty;var it=(e,t)=>{for(var o in t)M(e,o,{get:t[o],enumerable:!0})},rt=(e,t,o,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of ot(t))!nt.call(e,s)&&s!==o&&M(e,s,{get:()=>t[s],enumerable:!(n=et(t,s))||n.enumerable});return e};var st=e=>rt(M({},"__esModule",{value:!0}),e);var yt={};it(yt,{$:()=>y,css:()=>J,html:()=>$,onMounted:()=>Q,onUnmounted:()=>tt,rain:()=>R});var k=function(e,t,o,n){var s;t[0]=0;for(var i=1;i<t.length;i++){var r=t[i++],f=t[i]?(t[0]|=r?1:2,o[t[i++]]):t[++i];r===3?n[0]=f:r===4?n[1]=Object.assign(n[1]||{},f):r===5?(n[1]=n[1]||{})[t[++i]]=f:r===6?n[1][t[++i]]+=f+"":r?(s=e.apply(f,k(e,f,o,["",null])),n.push(s),f[0]?t[0]|=2:(t[i-2]=0,t[i]=s)):n.push(f)}return n},P=new Map;function H(e){var t=P.get(this);return t||(t=new Map,P.set(this,t)),(t=k(this,t.get(e)||(t.set(e,t=(function(o){for(var n,s,i=1,r="",f="",c=[0],p=function(h){i===1&&(h||(r=r.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?c.push(0,h,r):i===3&&(h||r)?(c.push(3,h,r),i=2):i===2&&r==="..."&&h?c.push(4,h,0):i===2&&r&&!h?c.push(5,0,!0,r):i>=5&&((r||!h&&i===5)&&(c.push(i,0,r,s),i=6),h&&(c.push(i,h,0,s),i=6)),r=""},a=0;a<o.length;a++){a&&(i===1&&p(),p(a));for(var m=0;m<o[a].length;m++)n=o[a][m],i===1?n==="<"?(p(),c=[c],i=3):r+=n:i===4?r==="--"&&n===">"?(i=1,r=""):r=n+r[0]:f?n===f?f="":r+=n:n==='"'||n==="'"?f=n:n===">"?(p(),i=1):i&&(n==="="?(i=5,s=r,r=""):n==="/"&&(i<5||o[a][m+1]===">")?(p(),i===3&&(c=c[0]),i=c,(c=c[0]).push(2,0,i),i=0):n===" "||n==="	"||n===`
`||n==="\r"?(p(),i=2):r+=n),i===3&&r==="!--"&&(i=4,c=c[0])}return p(),c})(e)),t),arguments,[])).length>1?t:t[0]}var ft=Symbol.for("preact-signals");function T(){if(S>1)S--;else{for(var e,t=!1;_!==void 0;){var o=_;for(_=void 0,L++;o!==void 0;){var n=o.o;if(o.o=void 0,o.f&=-3,!(8&o.f)&&j(o))try{o.c()}catch(s){t||(e=s,t=!0)}o=n}}if(L=0,S--,t)throw e}}var u=void 0;function I(e){var t=u;u=void 0;try{return e()}finally{u=t}}var _=void 0,S=0,L=0,A=0;function B(e){if(u!==void 0){var t=e.n;if(t===void 0||t.t!==u)return t={i:0,S:e,p:u.s,n:void 0,t:u,e:void 0,x:void 0,r:t},u.s!==void 0&&(u.s.n=t),u.s=t,e.n=t,32&u.f&&e.S(t),t;if(t.i===-1)return t.i=0,t.n!==void 0&&(t.n.p=t.p,t.p!==void 0&&(t.p.n=t.n),t.p=u.s,t.n=void 0,u.s.n=t,u.s=t),t}}function l(e,t){this.v=e,this.i=0,this.n=void 0,this.t=void 0,this.W=t==null?void 0:t.watched,this.Z=t==null?void 0:t.unwatched,this.name=t==null?void 0:t.name}l.prototype.brand=ft;l.prototype.h=function(){return!0};l.prototype.S=function(e){var t=this,o=this.t;o!==e&&e.e===void 0&&(e.x=o,this.t=e,o!==void 0?o.e=e:I(function(){var n;(n=t.W)==null||n.call(t)}))};l.prototype.U=function(e){var t=this;if(this.t!==void 0){var o=e.e,n=e.x;o!==void 0&&(o.x=n,e.e=void 0),n!==void 0&&(n.e=o,e.x=void 0),e===this.t&&(this.t=n,n===void 0&&I(function(){var s;(s=t.Z)==null||s.call(t)}))}};l.prototype.subscribe=function(e){var t=this;return v(function(){var o=t.value,n=u;u=void 0;try{e(o)}finally{u=n}},{name:"sub"})};l.prototype.valueOf=function(){return this.value};l.prototype.toString=function(){return this.value+""};l.prototype.toJSON=function(){return this.value};l.prototype.peek=function(){var e=u;u=void 0;try{return this.value}finally{u=e}};Object.defineProperty(l.prototype,"value",{get:function(){var e=B(this);return e!==void 0&&(e.i=this.i),this.v},set:function(e){if(e!==this.v){if(L>100)throw new Error("Cycle detected");this.v=e,this.i++,A++,S++;try{for(var t=this.t;t!==void 0;t=t.x)t.t.N()}finally{T()}}}});function W(e,t){return new l(e,t)}function j(e){for(var t=e.s;t!==void 0;t=t.n)if(t.S.i!==t.i||!t.S.h()||t.S.i!==t.i)return!0;return!1}function F(e){for(var t=e.s;t!==void 0;t=t.n){var o=t.S.n;if(o!==void 0&&(t.r=o),t.S.n=t,t.i=-1,t.n===void 0){e.s=t;break}}}function G(e){for(var t=e.s,o=void 0;t!==void 0;){var n=t.p;t.i===-1?(t.S.U(t),n!==void 0&&(n.n=t.n),t.n!==void 0&&(t.n.p=n)):o=t,t.S.n=t.r,t.r!==void 0&&(t.r=void 0),t=n}e.s=o}function N(e,t){l.call(this,void 0),this.x=e,this.s=void 0,this.g=A-1,this.f=4,this.W=t==null?void 0:t.watched,this.Z=t==null?void 0:t.unwatched,this.name=t==null?void 0:t.name}N.prototype=new l;N.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===A))return!0;if(this.g=A,this.f|=1,this.i>0&&!j(this))return this.f&=-2,!0;var e=u;try{F(this),u=this;var t=this.x();(16&this.f||this.v!==t||this.i===0)&&(this.v=t,this.f&=-17,this.i++)}catch(o){this.v=o,this.f|=16,this.i++}return u=e,G(this),this.f&=-2,!0};N.prototype.S=function(e){if(this.t===void 0){this.f|=36;for(var t=this.s;t!==void 0;t=t.n)t.S.S(t)}l.prototype.S.call(this,e)};N.prototype.U=function(e){if(this.t!==void 0&&(l.prototype.U.call(this,e),this.t===void 0)){this.f&=-33;for(var t=this.s;t!==void 0;t=t.n)t.S.U(t)}};N.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var e=this.t;e!==void 0;e=e.x)e.t.N()}};Object.defineProperty(N.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var e=B(this);if(this.h(),e!==void 0&&(e.i=this.i),16&this.f)throw this.v;return this.v}});function q(e,t){return new N(e,t)}function K(e){var t=e.u;if(e.u=void 0,typeof t=="function"){S++;var o=u;u=void 0;try{t()}catch(n){throw e.f&=-2,e.f|=8,U(e),n}finally{u=o,T()}}}function U(e){for(var t=e.s;t!==void 0;t=t.n)t.S.U(t);e.x=void 0,e.s=void 0,K(e)}function ct(e){if(u!==this)throw new Error("Out-of-order effect");G(this),u=e,this.f&=-2,8&this.f&&U(this),T()}function x(e,t){this.x=e,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32,this.name=t==null?void 0:t.name}x.prototype.c=function(){var e=this.S();try{if(8&this.f||this.x===void 0)return;var t=this.x();typeof t=="function"&&(this.u=t)}finally{e()}};x.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,K(this),F(this),S++;var e=u;return u=this,ct.bind(this,e)};x.prototype.N=function(){2&this.f||(this.f|=2,this.o=_,_=this)};x.prototype.d=function(){this.f|=8,1&this.f||U(this)};x.prototype.dispose=function(){this.d()};function v(e,t){var o=new x(e,t);try{o.c()}catch(s){throw o.d(),s}var n=o.d.bind(o);return n[Symbol.dispose]=n,n}var C=Symbol("rain.signal");function O(e){return typeof e=="function"&&e[C]}function D(e,t,o){t in e&&typeof e[t]!="function"?e[t]=o:o==null||o===!1?e.removeAttribute(t):o===!0?e.setAttribute(t,""):e.setAttribute(t,String(o))}function ut(e,t,o){if(t.startsWith("@")&&typeof o=="function"){let n=t.slice(1);e.addEventListener(n,o)}else if(t.startsWith(".")){let n=t.slice(1);O(o)?v(()=>{e[n]=o()}):typeof o=="function"&&o[C]?v(()=>{e[n]=o()}):e[n]=o}else O(o)?v(()=>{D(e,t,o())}):typeof o=="function"&&o[C]?v(()=>{D(e,t,o())}):D(e,t,o)}function at(e,t,...o){if(e==="frag"){let i=document.createElement("div");i.style.display="contents";for(let r of o.flat(1/0))V(i,r);return i}if(typeof e!="string"||!e)throw new Error(`Invalid element type: ${e}`);let n=document.createElement(e),s=null;for(let i of o.flat(1/0))V(n,i);if(t)for(let[i,r]of Object.entries(t))n.tagName==="SELECT"&&i==="value"&&O(r)?s=r:ut(n,i,r);return s&&v(()=>{n.value=s()}),n}function V(e,t){if(t!=null)if(typeof t=="string"||typeof t=="number")e.appendChild(document.createTextNode(String(t)));else if(typeof t=="function"&&t[C]){let o=null;v(()=>{let n=t();n instanceof Node?(o&&o.parentNode===e&&e.removeChild(o),e.appendChild(n),o=n):((!o||o.nodeType!==Node.TEXT_NODE)&&(o&&o.parentNode===e&&e.removeChild(o),o=document.createTextNode(""),e.appendChild(o)),o.textContent=String(n!=null?n:""))})}else t instanceof Node&&e.appendChild(t)}var dt=H.bind(at),lt=0,pt=()=>++lt;function $(e,...t){let o=[...e];return o[o.length-1]+=`<!-- ${pt()} -->`,dt(o,...t)}function Z(e){Array.from(e.children).forEach(t=>{t._listCleanup||t.remove()})}function z(e,t){if(!t||!t.appendChild)throw new Error(`render() expects a DOM element as container, got ${typeof t}`);Z(t);let o=typeof e=="function"?e():e;return o instanceof Node?(t.appendChild(o),{dispose:()=>{Z(t)}}):{dispose:()=>{}}}function y(e){let t=W(e),o=()=>t.value,n=s=>{t.value=s};return o[C]=t,n[C]=t,[o,n]}y.computed=function(e){if(typeof e!="function")throw new Error("$.computed expects a function, got "+typeof e);let t=q(e),o=()=>t.value;return o[C]=t,o};y.effect=function(e){if(typeof e!="function")throw new Error("$.effect expects a function, got "+typeof e);return v(e)};y.listen=function(e,t,o=document){if(typeof e!="string")throw new Error("$.listen expects eventName to be a string");if(typeof t!="function")throw new Error("$.listen expects handler to be a function");return o.addEventListener(e,t),()=>{o.removeEventListener(e,t)}};y.emit=function(e,t,o){if(typeof e!="string")throw new Error("$.emit expects eventName to be a string");let n=o||document,s=new CustomEvent(e,{detail:t,bubbles:!0,composed:!0});n.dispatchEvent(s)};function J(e,...t){if(!Array.isArray(e))throw new Error("css must be used as a template literal");return y.computed(()=>{let o="";for(let s=0;s<e.length;s++)if(o+=e[s],s<t.length){let i=t[s];o+=typeof i=="function"&&i[C]?i():i}let n=document.createElement("style");return n.textContent=o,n})}y.if=function(e,t,o){if(typeof e!="function"||!e[C])throw new Error("$.if() expects a signal as first argument");let n=document.createElement("div");n.style.display="contents";let s=null,i=v(()=>{let r=e();s&&s.parentNode===n&&(s.remove(),s=null);let f=r?t:o;if(f&&typeof f=="function"){let c=f();c&&c instanceof Node&&(n.appendChild(c),s=c)}});return n._listCleanup=i,n};y.list=function(e,t,o){let n=document.createElement("div");n.style.display="contents",n._listCleanup=!0;let s=null;if(o){let i=new Map;s=v(()=>{let r=e();if(!Array.isArray(r))return;if(r.length===0){for(let[,d]of i)d.parentNode===n&&d.remove();i.clear();return}let f=r.map((d,w)=>o(d,w)),c=f.every(d=>d!=null),p=new Set(f).size===f.length;if(!c||!p){typeof window!="undefined"&&window.RAIN_DEBUG&&console.log("[Rain:List] Invalid keys, falling back to full re-render"),Array.from(n.children).forEach(d=>d.remove()),i.clear(),r.forEach((d,w)=>{let E=t(d,w);if(!E||!(E instanceof Node))throw new Error(`renderFn must return a DOM Node, got ${typeof E}`);n.appendChild(E)});return}let a=new Set,m=[];r.forEach((d,w)=>{let E=f[w],b=i.get(E);if(a.add(E),!b){if(b=t(d,w),!b||!(b instanceof Node))throw new Error(`renderFn must return a DOM Node, got ${typeof b}`);i.set(E,b)}m.push(b)}),Array.from(n.children).forEach(d=>{d.parentNode===n&&n.removeChild(d)}),m.forEach(d=>{n.appendChild(d)});for(let[d,w]of i)a.has(d)||(w.parentNode===n&&w.remove(),i.delete(d))})}else s=v(()=>{let i=e();Array.isArray(i)&&(Array.from(n.children).forEach(r=>r.remove()),i.forEach((r,f)=>{let c=t(r,f);if(!c||!(c instanceof Node))throw new Error(`renderFn must return a DOM Node, got ${typeof c}`);n.appendChild(c)}))});return n._listCleanup=s,n};y.DHTML=function(e){if(typeof e!="string")throw new Error("$.DHTML expects a string");let t=document.createElement("div");t.innerHTML=e;let o=document.createDocumentFragment();for(;t.firstChild;)o.appendChild(t.firstChild);return o};function X(e,t,o){if(typeof t=="function"&&(o=t,t=[]),!e||typeof e!="string")throw new Error("Component name is required and must be a string");if(!o||typeof o!="function")throw new Error("Component factory function is required");if(t&&!Array.isArray(t))throw new Error("Props must be an array of strings");return{name:e,propNames:t||[],factory:o}}function ht(e){e._m=[],e._um=[]}function vt(e){e._cleanups=new Set}function Y(e,t,o,n="closed"){let s=class extends HTMLElement{static get observedAttributes(){return this._propNames||[]}constructor(){super();let i=this.constructor._propNames,r={};this._propSetters={};for(let a of i||[]){let[m,h]=y(this.getAttribute(a)||"");r[a]=m,this._propSetters[a]=h}ht(this),vt(this);let f=this.attachShadow({mode:n});g=this,this.emit=(a,m)=>{this.dispatchEvent(new CustomEvent(a,{detail:m,bubbles:!0,composed:!0}))};let c;try{c=o.call(this,r)}catch(a){console.error(`Component error in ${e} during factory:`,a),c=()=>$`<div style="color: red; padding: 1rem;">
          Component "${e}" failed to render. Check console for details.
        </div>`}g=null;let p;try{p=c()}catch(a){console.error(`Component error in ${e} during render:`,a),p=$`<div style="color: red; padding: 1rem;">
          Component "${e}" failed to render. Check console for details.
        </div>`}try{z(p,f)}catch(a){console.error(`Component error in ${e} during render-critical:`,a),f.innerHTML=`<div style="padding: 1rem; background: #fee; border: 1px solid #fcc;">
          <strong style="color: #c00;">Critical Render Error: ${e}</strong>
        </div>`}this._root=f,this._isMounted=!1}_cleanupElement(i){i._listCleanup&&typeof i._listCleanup=="function"&&(i._listCleanup(),i._listCleanup=null),Array.from(i.children).forEach(r=>{this._cleanupElement(r)})}connectedCallback(){var i;this._isMounted=!0,(i=this._m)==null||i.forEach(r=>{try{r()}catch(f){console.error(`Component error in ${this.tagName.toLowerCase()} during connected:`,f)}})}disconnectedCallback(){var i,r;(i=this._cleanups)==null||i.forEach(f=>{if(typeof f=="function")try{f()}catch(c){console.error(`Component error in ${this.tagName.toLowerCase()} during cleanup:`,c)}}),(r=this._um)==null||r.forEach(f=>{try{f()}catch(c){console.error(`Component error in ${this.tagName.toLowerCase()} during unmount:`,c)}})}attributeChangedCallback(i,r,f){this._propSetters&&this._propSetters[i]&&this._propSetters[i](f||"")}};return s._propNames=t,s}var g;function R(e,t,o){try{let{name:n,propNames:s,factory:i}=X(e,t,o);if(customElements.get(n))return typeof window!="undefined"&&window.RAIN_DEBUG&&console.log(`[Rain:Component] '${n}' already defined, skipping`),!0;let r=Y(n,s,i,"closed");return customElements.define(n,r),!0}catch(n){return console.error(`Failed to register component '${e}':`,n),!1}}R.open=function(e,t,o){try{let{name:n,propNames:s,factory:i}=X(e,t,o);if(customElements.get(n))return typeof window!="undefined"&&window.RAIN_DEBUG&&console.log(`[Rain:Component] '${n}' already defined, skipping`),!0;let r=Y(n,s,i,"open");return customElements.define(n,r),!0}catch(n){return console.error(`Failed to register component '${e}':`,n),!1}};function Q(e){if(!g){console.warn("onMounted called outside component factory");return}(g._m||(g._m=[])).push(e)}function tt(e){if(!g){console.warn("onUnmounted called outside component factory");return}(g._um||(g._um=[])).push(e)}return st(yt);})();
/**
 * @fileoverview RainJS - Reactive Web Components with HTM templates and Preact signals
 * @version 0.0.9
 * @author RainJS Team
 * @license MIT
 */
//# sourceMappingURL=rainwc.umd.min.js.map
